(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,a){e.exports=a(237)},111:function(e,t,a){},112:function(e,t,a){},215:function(e,t,a){},217:function(e,t,a){},218:function(e,t,a){},237:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(35),o=a.n(c),i=a(3),l=a(14),u=(a(111),a(13)),s=a(20),m=a(22),p=a(21),d=a(23),h=a(10),E=n.a.createContext(),f=E.Provider,y=E.Consumer,b=function(){return function(e){return function(t){return n.a.createElement(y,null,function(a){return n.a.createElement(e,Object.assign({},t,{forecastService:a}))})}}},v=function(e){return{type:"NEW_CITY_INPUT",payload:e}},w=function(){return{type:"UPDATE_HISTORY"}},C=function(e){return function(t){return function(a){a({type:"FETCHING_STARTED"}),e.getWeather(t).then(function(e){a({type:"TODAY_WEATHER_FETCH_SUCCESS",payload:e})}).then(function(){e.getWeekWeather(t).then(function(e){a({type:"WEEK_WEATHER_FETCH_SUCCESS",payload:e}),a({type:"FETCHING_FINISHED"})}).then(function(){a({type:"UPDATE_HISTORY"})})}).catch(function(e){return a(W())})}}},W=function(){return{type:"ERROR_CATCHED",payload:!0}},O=a(15),_=(a(112),function(){return n.a.createElement("nav",{className:"navbar navbar-dark bg-primary"},n.a.createElement("span",{className:"navbar-brand"},"FORECAST APP"))}),H=function(e){function t(){var e,a;Object(u.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={inputValue:""},a.onChangeHandler=function(e){a.setState({inputValue:e.target.value})},a.onClickButtonHandler=function(){var e=a.props,t=e.fetchNewCity,r=e.fetchWeatherThunk,n=a.state.inputValue;""!==n&&(t(n),r(n))},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"input-group pl-3 pt-3 pb-3",style:{width:500}},n.a.createElement("input",{type:"text",className:"form-control",placeholder:"Input city here...","aria-label":"Example text with button addon","aria-describedby":"button-addon1",onChange:this.onChangeHandler}),n.a.createElement("div",{className:"input-group-prepend"},n.a.createElement("button",{className:"btn btn-primary",type:"button",id:"button-addon1",onClick:this.onClickButtonHandler},"Search city forecast")))}}]),t}(r.Component),k=b()(Object(i.b)(function(e){return{currentCity:e.currentCity}},function(e,t){var a=t.forecastService;return Object(h.b)({fetchWeatherThunk:C(a),fetchNewCity:v},e)})(H)),T=a(29),N=a.n(T),g=(a(215),function(){return n.a.createElement("div",{className:"loader"},"Loading...")}),j=Object(i.b)(function(e){return{todayWeather:e.todayWeather}},{})(function(e){var t=e.todayWeather;if(t){var a=t.city,r=t.humidity,c=t.temp,o=t.temp_max,i=t.temp_min,u=t.weather,s=t.icon;return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"card-body"},n.a.createElement("h2",{className:"card-title"},a,n.a.createElement("span",{className:"ml-3",style:{fontSize:25}},N.a.format(new Date,"D MMMM YYYY"))),n.a.createElement("table",{className:"table table-striped",style:{width:500}},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"}),n.a.createElement("td",null,n.a.createElement("img",{src:"http://api.openweathermap.org/img/w/".concat(s),alt:"img"}))),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Weather"),n.a.createElement("td",null,u)),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Temperature"),n.a.createElement("td",null,c,"\xb0C")),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Humidity"),n.a.createElement("td",null,r,"%")),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Temperature max/min"),n.a.createElement("td",null,o,"/",i)))),n.a.createElement(l.b,{to:"/react-redux-forecast/week"},n.a.createElement("span",{className:"btn btn-primary"},"Show week forecast"))))}return n.a.createElement(g,null)}),S=Object(i.b)(function(e){return{weekWeather:e.weekWeather}},{})(function(e){var t=e.weekWeather;if(void 0!==t.city){var a=t.city,r=t.list;return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"card-body"},n.a.createElement("h2",{className:"card-title"},a),n.a.createElement("table",{className:"table table-striped"},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Date"),r.map(function(e,t){return n.a.createElement("td",{key:t,className:"font-weight-bold"},N.a.format(N.a.addDays(new Date,t),"D MMMM YYYY"))})),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"}),r.map(function(e,t){return n.a.createElement("td",{key:t,className:"font-weight-bold"},n.a.createElement("img",{src:"http://api.openweathermap.org/img/w/".concat(e.weather[0].icon),alt:"img"}))})),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Weather"),r.map(function(e,t){return n.a.createElement("td",{key:t},e.weather[0].description)})),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Temperature"),r.map(function(e,t){return n.a.createElement("td",{key:t},e.main.temp,"\xb0C")})),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Humidity"),r.map(function(e,t){return n.a.createElement("td",{key:t},e.main.humidity,"%")})),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},"Temperature max/min"),r.map(function(e,t){return n.a.createElement("td",{key:t},e.main.temp_max,"\xb0C/",e.main.temp_max,"\xb0C")})))),n.a.createElement(l.b,{to:"/react-redux-forecast/"},n.a.createElement("span",{className:"btn btn-primary"},"Go back"))))}return n.a.createElement(g,null)}),x=(a(217),{updateWeatherFromHirtory:function(e){return{type:"UPDATE_WEATHER_FROM_HISTORY",payload:e}}}),D=Object(i.b)(function(e){return{forecastHistory:e.forecastHistory}},x)(function(e){var t=e.forecastHistory,a=e.updateWeatherFromHirtory;return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"card-body"},n.a.createElement("h2",{className:"card-title"},"Forecast History")),n.a.createElement("div",{className:"table table-striped"},n.a.createElement("div",{className:" d-flex"},t.map(function(e){var t=e.todayWeather,r=t.id,c=t.city,o=t.weather,i=t.temp,l=t.icon;return n.a.createElement("div",{key:r,className:"forecast-card d-flex justify-content-between",onClick:function(){return a(r)}},n.a.createElement("div",null,n.a.createElement("h4",null,c),n.a.createElement("p",null,o),n.a.createElement("p",null,i,"\xb0C")),n.a.createElement("div",{className:"forecast-card-icon-block"},n.a.createElement("img",{className:"forecast-card-icon",src:"http://api.openweathermap.org/img/w/".concat(l),alt:"img"})))}))))}),A=(a(218),function(){return n.a.createElement("div",{className:"error-indicator"},n.a.createElement("div",null,n.a.createElement("i",{class:"fas fa-cloud icon"})),n.a.createElement("span",{className:"error-title"},"Forecast App Error"),n.a.createElement("span",{className:"error-text"},"Check your input and try again"))}),R=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidCatch",value:function(){this.props.errorCatched()}},{key:"render",value:function(){return this.props.hasError?n.a.createElement(A,null):this.props.children}}]),t}(r.Component),I={errorCatched:W},F=Object(i.b)(function(e){return{hasError:e.hasError}},I)(R),Y=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.fetchWeatherThunk)("Kiev")}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(_,null),n.a.createElement(k,null),n.a.createElement(F,null,n.a.createElement(O.c,null,n.a.createElement(O.a,{path:"/react-redux-forecast/",component:j,exact:!0}),n.a.createElement(O.a,{path:"/react-redux-forecast/week",component:S}),n.a.createElement(O.a,{path:"/react-redux-forecast/"}))),n.a.createElement(D,null))}}]),t}(r.Component),P=b()(Object(i.b)(function(e){return{currentCity:e.currentCity}},function(e,t){var a=t.forecastService;return Object(h.b)({fetchWeatherThunk:C(a),updateHistory:w},e)})(Y)),M=a(19),U=a.n(M),B=a(37),K=a(99),G=a.n(K),V=a(100),q=a.n(V),J=a(101),z=a(12),L=a(38),Q={currentCity:"",todayWeather:{},weekWeather:{},forecastHistory:[],hasError:!1},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TODAY_WEATHER_FETCH_SUCCESS":return Object(z.a)({},e,{todayWeather:t.payload});case"WEEK_WEATHER_FETCH_SUCCESS":return Object(z.a)({},e,{weekWeather:t.payload});case"ERROR_CATCHED":return Object(z.a)({},e,{hasError:t.payload});case"NEW_CITY_INPUT":return Object(z.a)({},e,{currentCity:t.payload});case"FETCHING_STARTED":return Object(z.a)({},e,{hasError:!1});case"FETCHING_FINISHED":return Object(z.a)({},e);case"UPDATE_HISTORY":return Object(z.a)({},e,{forecastHistory:function(){var t={city:e.currentCity,todayWeather:e.todayWeather,weekWeather:e.weekWeather},a=[],r=e.todayWeather.id,n=e.forecastHistory.find(function(e){return e.todayWeather.id===r});if(e.forecastHistory.length>=5&&void 0===n)a=[].concat(Object(L.a)(e.forecastHistory.slice(1)),[t]);else if(e.forecastHistory.length<=5&&void 0===n)a=[].concat(Object(L.a)(e.forecastHistory),[t]);else if(e.forecastHistory.length<=5&&void 0!==n){var c=n.todayWeather.id;console.log(c),a=[].concat(Object(L.a)(e.forecastHistory.filter(function(e){return e.todayWeather.id!==c})),[t])}return a}()});case"UPDATE_WEATHER_FROM_HISTORY":return Object(z.a)({},e,function(t){var a=e.forecastHistory.find(function(e){return e.todayWeather.id===t});return console.log(a),{todayWeather:a.todayWeather,weekWeather:a.weekWeather,currentCity:a.city}}(t.payload));default:return e}},Z=Object(h.c)(X,Object(h.a)(J.a,q.a)),$=new function e(){var t=this;Object(u.a)(this,e),this._apiKey="b4655c5e515d5be817ed70a0a7f55407",this._apiBase="//api.openweathermap.org/data/2.5/",this.getData=function(){var e=Object(B.a)(U.a.mark(function e(t){var a;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.a.get(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),this.getWeather=function(){var e=Object(B.a)(U.a.mark(function e(a){var r;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getData("".concat(t._apiBase,"weather?q=").concat(a,"&APPID=").concat(t._apiKey,"&units=metric"));case 2:return r=e.sent,e.abrupt("return",t._transformWeather(r));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.getWeekWeather=function(){var e=Object(B.a)(U.a.mark(function e(a){var r;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getData("".concat(t._apiBase,"forecast?q=").concat(a,"&APPID=").concat(t._apiKey,"&units=metric"));case 2:return r=e.sent,e.abrupt("return",t._transformWeekWeather(r));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this._transformWeather=function(e){return{id:e.id,city:e.name,weather:e.weather[0].description,icon:e.weather[0].icon,temp:e.main.temp,humidity:e.main.humidity,temp_max:e.main.temp_max,temp_min:e.main.temp_min}},this._transformWeekWeather=function(e){return{city:e.city.name,list:[e.list[0],e.list[7],e.list[15],e.list[23],e.list[31],e.list[39]]}}};o.a.render(n.a.createElement(i.a,{store:Z},n.a.createElement(l.a,{basename:"/react-redux-forecast"},n.a.createElement(f,{value:$},n.a.createElement(l.a,null,n.a.createElement(P,null))))),document.getElementById("root"))}},[[102,1,2]]]);
//# sourceMappingURL=main.c1aa4d8f.chunk.js.map